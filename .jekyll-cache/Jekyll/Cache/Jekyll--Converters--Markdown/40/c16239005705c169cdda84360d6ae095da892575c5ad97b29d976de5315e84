I"óV<!-- jekyll serve --drafts -->

<h3 id="introduction">Introduction</h3>

<p>test</p>
<h3 id="wyvern-v22-ì·¨ì•½ì ">Wyvern v2.2 ì·¨ì•½ì </h3>

<p>2022ë…„ 1ë¶„ê¸°ì—, ì˜¤í”ˆì”¨ê°€ ì‚¬ìš©í•˜ë˜ Wyvern v2.2 í”„ë¡œí† ì½œ ì»¨íŠ¸ë™íŠ¸ì—ì„œ í¬ë¦¬í‹°ì»¬í•œ ì·¨ì•½ì ì´ ë°œê²¬ë˜ì—ˆë‹¤. í•´ë‹¹ ì·¨ì•½ì ì„ ì´ìš©í•˜ë©´, ê³µê²©ìëŠ” offerë¥¼ ìˆ˜í–‰í•œ ì‚¬ìš©ìë“¤ì—ê²Œì„œ ETHë¥¼ íƒˆì·¨í•  ìˆ˜ ìˆì—ˆë‹¤. ë‹¤í–‰ì¸ ì ì€ ë¬¸ì œê°€ ë°œê²¬ë˜ê³  ê·¸ë™ì•ˆì˜ ë¡œê·¸ë¥¼ ë¶„ì„í•´ë´¤ì„ ë•Œ í•´ë‹¹ ì·¨ì•½ì ì„ ì´ìš©í•œ ê³µê²©ì€ ì—†ì—ˆë‹¤ê³  í•œë‹¤. ì˜¤í”ˆì”¨ëŠ” off-chain ì„œëª…ì„ í†µí•´ ê±°ë˜ë¥¼ ì²˜ë¦¬í•´ì™”ëŠ”ë°, í•´ë‹¹ ì„œëª…ì—ì„œ ì‚¬ìš©í•˜ë˜ order êµ¬ì¡°ì²´ì—ì„œ ì·¨ì•½ì ì´ ë°œê²¬ë˜ì—ˆë‹¤.</p>

<p><a href="https://nft.mirror.xyz/VdF3BYwuzXgLrJglw5xF6CHcQfAVbqeJVtueCr4BUzs">CTO of Opensa: A critical vulnerability in Wyvern Protocol</a>ì—ì„œ ì´ ì·¨ì•½ì ì— ëŒ€í•´ ìì„¸íˆ ì„¤ëª…í•˜ê³ ìˆë‹¤. í•´ë‹¹ ì·¨ì•½ì ì€ Horton ì›ì¹™ì„ ìœ„ë°˜í•˜ë©´ì„œ ë°œìƒí•˜ì˜€ë‹¤. Hortion ì›ì¹™ì€ ì•”í˜¸í•™ ì‹œìŠ¤í…œì˜ ë””ìì¸ ì›ì¹™ìœ¼ë¡œì„œ, â€œë§í•˜ëŠ” ë°”ê°€ ì•„ë‹ˆë¼ ì˜ë¯¸í•˜ëŠ” ë°”ë¥¼ ì¸ì¦í•´ë¼ (Authenticate what is being meant, not what is being said)â€ë¼ëŠ” í‘œí˜„ì´ë‹¤. ì´ëŸ¬í•œ ì›ì¹™ì€ ë©”ì‹œì§€ ì¸ì¦ ì½”ë“œ(Message Authentication Codes, MAC)ë¥¼ ì‚¬ìš©í•  ë•Œ ë§¤ìš° ì¤‘ìš”í•œë°, ì•¨ë¦¬ìŠ¤ê°€ ë°¥ì—ê²Œ ë©”ì‹œì§€ <code class="language-plaintext highlighter-rouge">m := a | b | c</code>ì„ MACê³¼ í•¨ê»˜ ë³´ë‚´ ë©”ì‹œì§€ë¥¼ ì¸ì¦í•˜ë”ë¼ë„, ë°¥ì´ í•´ë‹¹ ë©”ì‹œì§€ë¥¼ ì»´í¬ë„ŒíŠ¸ a, b, cë¡œ ì •í™•íˆ ë¶„í• í•˜ëŠ” ë°©ë²•ì„ ëª¨ë¥¸ë‹¤ë©´ ì˜ëª»ëœ ì˜ë¯¸ë¡œ í•´ì„ë  ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ Hortion ì›ì¹™ì€ ë©”ì‹œì§€ ê·¸ ìì²´ê°€ ì•„ë‹Œ ì˜ë¯¸í•˜ëŠ” ë°”(meaning)ë¥¼ ì¸ì¦í•˜ë„ë¡ í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´, MACì€ ë©”ì‹œì§€ mì˜ ë°”ì´íŠ¸ ìŠ¤íŠ¸ë§ ìì²´ë§Œì„ ì¸ì¦í•˜ë¯€ë¡œ, ë©”ì‹œì§€ mì´ êµ¬ì„±ë˜ëŠ” ë°©ì‹ ë˜í•œ ì¸ì¦í•˜ë„ë¡ í•˜ì—¬ì•¼í•œë‹¤. ì´ëŠ” <a href="https://github.com/ethereum/EIPs/blob/master/EIPS/eip-712.md">EIP712</a>ì²˜ëŸ¼ ë©”ì‹œì§€ë¥¼ êµ¬ì¡°í™”, í˜•ì‹í™”í•˜ê³  ë©”ì‹œì§€ì˜ í¬ë§·ì„ ì„œëª…ì— í¬í•¨í•˜ë„ë¡ í•¨ìœ¼ë¡œì¨ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤. ì´ì œ Horton ì›ì¹™ì„ ìœ„ë°˜í•´ì„œ ë°œìƒí–ˆë˜ Wyvern v2.2 ì·¨ì•½ì ì— ëŒ€í•´ ìì„¸íˆ ì•Œì•„ë³´ì.</p>

<p>ì˜¤í”ˆì”¨ì—ì„œëŠ” off-chain ì„œëª…ì„ í†µí•´ íŒë§¤ì™€ êµ¬ë§¤ë¥¼ ìˆ˜í–‰í•œë‹¤. Wyvern v2.2ì—ì„œëŠ” <a href="https://github.com/ethereum/EIPs/blob/master/EIPS/eip-712.md">EIP712</a>ê°€ ì ìš©ë˜ê¸° ì „ìœ¼ë¡œ ì•„ë˜ ì½”ë“œì— ë‚˜ì™€ìˆëŠ” <a href="https://github.com/ProjectWyvern/wyvern-ethereum/blob/master/contracts/exchange/ExchangeCore.sol#L92">order êµ¬ì¡°ì²´</a>ì— ì„œëª…ì„ ìˆ˜í–‰í•œë‹¤.</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/* An order on the exchange. */</span>
<span class="k">struct</span> <span class="n">Order</span> <span class="p">{</span>
    <span class="cm">/* Exchange address, intended as a versioning mechanism. */</span>
    <span class="kt">address</span> <span class="n">exchange</span><span class="p">;</span>
    <span class="cm">/* Order maker address. */</span>
    <span class="kt">address</span> <span class="n">maker</span><span class="p">;</span>
    <span class="cm">/* Order taker address, if specified. */</span>
    <span class="kt">address</span> <span class="n">taker</span><span class="p">;</span>
    <span class="cm">/* Maker relayer fee of the order, unused for taker order. */</span>
    <span class="kt">uint</span> <span class="n">makerRelayerFee</span><span class="p">;</span>
    <span class="cm">/* Taker relayer fee of the order, or maximum taker fee for a taker order. */</span>
    <span class="kt">uint</span> <span class="n">takerRelayerFee</span><span class="p">;</span>
    <span class="cm">/* Maker protocol fee of the order, unused for taker order. */</span>
    <span class="kt">uint</span> <span class="n">makerProtocolFee</span><span class="p">;</span>
    <span class="cm">/* Taker protocol fee of the order, or maximum taker fee for a taker order. */</span>
    <span class="kt">uint</span> <span class="n">takerProtocolFee</span><span class="p">;</span>
    <span class="cm">/* Order fee recipient or zero address for taker order. */</span>
    <span class="kt">address</span> <span class="n">feeRecipient</span><span class="p">;</span>
    <span class="cm">/* Fee method (protocol token or split fee). */</span>
    <span class="n">FeeMethod</span> <span class="n">feeMethod</span><span class="p">;</span>
    <span class="cm">/* Side (buy/sell). */</span>
    <span class="n">SaleKindInterface</span><span class="p">.</span><span class="n">Side</span> <span class="n">side</span><span class="p">;</span>
    <span class="cm">/* Kind of sale. */</span>
    <span class="n">SaleKindInterface</span><span class="p">.</span><span class="n">SaleKind</span> <span class="n">saleKind</span><span class="p">;</span>
    <span class="cm">/* Target. */</span>
    <span class="kt">address</span> <span class="n">target</span><span class="p">;</span>
    <span class="cm">/* HowToCall. */</span>
    <span class="n">AuthenticatedProxy</span><span class="p">.</span><span class="n">HowToCall</span> <span class="n">howToCall</span><span class="p">;</span>
    <span class="cm">/* Calldata. */</span>
    <span class="kt">bytes</span> <span class="k">calldata</span><span class="p">;</span>
    <span class="cm">/* Calldata replacement pattern, or an empty byte array for no replacement. */</span>
    <span class="kt">bytes</span> <span class="n">replacementPattern</span><span class="p">;</span>
    <span class="cm">/* Static call target, zero-address for no static call. */</span>
    <span class="kt">address</span> <span class="n">staticTarget</span><span class="p">;</span>
    <span class="cm">/* Static call extra data. */</span>
    <span class="kt">bytes</span> <span class="n">staticExtradata</span><span class="p">;</span>
    <span class="cm">/* Token used to pay for the order, or the zero-address as a sentinel value for Ether. */</span>
    <span class="kt">address</span> <span class="n">paymentToken</span><span class="p">;</span>
    <span class="cm">/* Base price of the order (in paymentTokens). */</span>
    <span class="kt">uint</span> <span class="n">basePrice</span><span class="p">;</span>
    <span class="cm">/* Auction extra parameter - minimum bid increment for English auctions, starting/ending price difference. */</span>
    <span class="kt">uint</span> <span class="n">extra</span><span class="p">;</span>
    <span class="cm">/* Listing timestamp. */</span>
    <span class="kt">uint</span> <span class="n">listingTime</span><span class="p">;</span>
    <span class="cm">/* Expiration timestamp - 0 for no expiry. */</span>
    <span class="kt">uint</span> <span class="n">expirationTime</span><span class="p">;</span>
    <span class="cm">/* Order salt, used to prevent duplicate hashes. */</span>
    <span class="kt">uint</span> <span class="n">salt</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>ìœ„ ì½”ë“œì²˜ëŸ¼ orderëŠ” ë§¤ìš° ë§ì€ ë°ì´í„°ë“¤ì„ ë‹´ê³  ìˆëŠ”ë°, ë¬¸ì œê°€ ë˜ëŠ” ë¶€ë¶„ì€ <code class="language-plaintext highlighter-rouge">calldata</code>, <code class="language-plaintext highlighter-rouge">replacementPattern</code>, <code class="language-plaintext highlighter-rouge">staticExtradata</code>ì™€ ê°™ì€ Bytes ë°ì´í„°ë“¤ì´ë‹¤. ì •í•´ì§„ ê¸¸ì´ê°€ ì—†ëŠ” ì„ì˜ì˜ ê°’ë“¤ì´ê¸° ë•Œë¬¸ì— í•´ë‹¹ ë°ì´í„°ë“¤ê°„ì— ë°”ì´íŠ¸ë“¤ì„ ì´ë™ (shifted) ì‹œí‚´ìœ¼ë¡œì¨ ê³µê²©ì´ ìˆ˜í–‰ë  ìˆ˜ ìˆë‹¤.</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * @dev Hash an order, returning the canonical order hash, without the message prefix
 * @param order Order to hash
 * @return Hash of order
 */</span>
<span class="k">function</span> <span class="n">hashOrder</span><span class="p">(</span><span class="n">Order</span> <span class="k">memory</span> <span class="n">order</span><span class="p">)</span>
    <span class="k">internal</span>
    <span class="k">pure</span>
    <span class="k">returns</span> <span class="p">(</span><span class="kt">bytes32</span> <span class="n">hash</span><span class="p">)</span>
<span class="p">{</span>
    <span class="cm">/* Unfortunately abi.encodePacked doesn't work here, stack size constraints. */</span>
    <span class="kt">uint</span> <span class="n">size</span> <span class="o">=</span> <span class="n">sizeOf</span><span class="p">(</span><span class="n">order</span><span class="p">);</span>
    <span class="kt">bytes</span> <span class="k">memory</span> <span class="n">array</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">bytes</span><span class="p">(</span><span class="n">size</span><span class="p">);</span>
    <span class="kt">uint</span> <span class="n">index</span><span class="p">;</span>
    <span class="k">assembly</span> <span class="p">{</span>
        <span class="n">index</span> <span class="o">:=</span> <span class="n">add</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteAddress</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="n">exchange</span><span class="p">);</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteAddress</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="n">maker</span><span class="p">);</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteAddress</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="n">taker</span><span class="p">);</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteUint</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="n">makerRelayerFee</span><span class="p">);</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteUint</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="n">takerRelayerFee</span><span class="p">);</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteUint</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="n">makerProtocolFee</span><span class="p">);</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteUint</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="n">takerProtocolFee</span><span class="p">);</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteAddress</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="n">feeRecipient</span><span class="p">);</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteUint8</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="kt">uint8</span><span class="p">(</span><span class="n">order</span><span class="p">.</span><span class="n">feeMethod</span><span class="p">));</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteUint8</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="kt">uint8</span><span class="p">(</span><span class="n">order</span><span class="p">.</span><span class="n">side</span><span class="p">));</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteUint8</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="kt">uint8</span><span class="p">(</span><span class="n">order</span><span class="p">.</span><span class="n">saleKind</span><span class="p">));</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteAddress</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="n">target</span><span class="p">);</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteUint8</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="kt">uint8</span><span class="p">(</span><span class="n">order</span><span class="p">.</span><span class="n">howToCall</span><span class="p">));</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteBytes</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="k">calldata</span><span class="p">);</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteBytes</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="n">replacementPattern</span><span class="p">);</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteAddress</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="n">staticTarget</span><span class="p">);</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteBytes</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="n">staticExtradata</span><span class="p">);</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteAddress</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="n">paymentToken</span><span class="p">);</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteUint</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="n">basePrice</span><span class="p">);</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteUint</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="n">extra</span><span class="p">);</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteUint</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="n">listingTime</span><span class="p">);</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteUint</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="n">expirationTime</span><span class="p">);</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteUint</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="n">salt</span><span class="p">);</span>
    <span class="k">assembly</span> <span class="p">{</span>
        <span class="n">hash</span> <span class="o">:=</span> <span class="nb">keccak256</span><span class="p">(</span><span class="n">add</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">),</span> <span class="n">size</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">hash</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteAddress</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="n">target</span><span class="p">);</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteUint8</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="kt">uint8</span><span class="p">(</span><span class="n">order</span><span class="p">.</span><span class="n">howToCall</span><span class="p">));</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteBytes</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="k">calldata</span><span class="p">);</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteBytes</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="n">replacementPattern</span><span class="p">);</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteAddress</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="n">staticTarget</span><span class="p">);</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteBytes</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="n">staticExtradata</span><span class="p">);</span>
<span class="n">index</span> <span class="o">=</span> <span class="n">ArrayUtils</span><span class="p">.</span><span class="n">unsafeWriteAddress</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">order</span><span class="p">.</span><span class="n">paymentToken</span><span class="p">);</span>
</code></pre></div></div>

<p>ì•ì„œ ì‚´í´ë´£ë“¯ì´ ìœ„ì˜ êµ¬ì¡°ëŠ” Horton ì›ì¹™ì„ ìœ„ë°˜í•œë‹¤.</p>

<blockquote>
  <p>ì´ëŠ” <code class="language-plaintext highlighter-rouge">abi.encodePacked</code>ì„ ì„œëª…, ì¸ì¦ ë° ë°ì´í„° ë¬´ê²°ì„± ì²´í¬ì— í™•ì¸í•  ë•Œ ì£¼ì˜í•´ì•¼í•˜ëŠ” ì´ìœ ì™€ ë¹„ìŠ·í•˜ë‹¤.
<code class="language-plaintext highlighter-rouge">keccak256(abi.encodePacked(a, b))</code>ë¥¼ ê³„ì‚°í•  ë•Œ aì™€ bê°€ string, bytesì™€ ê°™ì€ ë™ì  íƒ€ì…ì´ë¼ë©´ aì™€ bì˜ ê°’ ì¼ë¶€ë¥¼ ì„œë¡œ ê°„ì— ì´ë™ì‹œì¼œë„ ë™ì¼í•œ ê²°ê³¼ ê°’ì„ ì–»ì„ ìˆ˜ ìˆë‹¤. ì˜ˆì‹œë¡œ ë³€ìˆ˜ string a = â€œtestâ€, string b = â€œcollisionâ€ì´ë¼ê³  í•´ë³´ì. <code class="language-plaintext highlighter-rouge">keccak256(abi.encodePacked(a, b)) = keccak256(abi.encodePacked("test", "collision")) = keccak256(abi.encodePacked("te", "stcollision"))</code>ì™€ ë™ì¼í•˜ë‹¤. ë”°ë¼ì„œ íŠ¹ë³„í•œ ì´ìœ ê°€ ì—†ë‹¤ë©´ abi.encode ì‚¬ìš©ì„ ê¶Œê³ í•œë‹¤. ì´ëŸ¬í•œ ê²½ê³ ëŠ” <a href="https://docs.soliditylang.org/en/latest/abi-spec.html#non-standard-packed-mode">Solidity Docs</a>ì— non-standard modeì˜ ì£¼ì˜ì‚¬í•­ìœ¼ë¡œ ë‚˜ì™€ìˆë‹¤.</p>
</blockquote>

<p>í•´ë‹¹ ì´ìŠˆëŠ” Wyvern v2.3ì—ì„œ <a href="https://github.com/ethereum/EIPs/blob/master/EIPS/eip-712.md">EIP712</a>ë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ í•´ê²°ë˜ì—ˆë‹¤.</p>

<h3 id="yulì„-í†µí•œ-seaportì˜-ê°€ìŠ¤-ìµœì í™”">Yulì„ í†µí•œ Seaportì˜ ê°€ìŠ¤ ìµœì í™”</h3>

<h3 id="reference">Reference</h3>
<ol>
  <li><a href="https://nft.mirror.xyz/VdF3BYwuzXgLrJglw5xF6CHcQfAVbqeJVtueCr4BUzs">CTO of Opensa: A critical vulnerability in Wyvern Protocol</a></li>
  <li><a href="https://blog.audit.haechi.io/wyvern_v2_2_1_1day_vulnerabilities">Haechi Audit: Wyvern v2.2 1-day Vulnerabilities</a></li>
  <li><a href="https://github.com/ethereum/EIPs/blob/master/EIPS/eip-712.md">EIP712</a></li>
</ol>

:ET